#}
simdata
simdata <- list()
n.obs <- 50
g10 <- 0.5
g20 <- 1
g11 <- 1
g12 <- -0.5
g21 <- 0.5
g22 <- -1
b11 <- 0.5
b12 <- -2
b21 <- 1
b22 <- -1
z1 <- rnorm(n.obs)
z2 <- rnorm(n.obs)
x1 <- z1
x2 <- z2
pi.r1.z <- exp(g10 + z1*g11 + z2*g12) / (1 + exp(g10 + z1*g11 + z2*g12))
pi.r2.z <- exp(g20 + z1*g21 + z2*g22) / (1 + exp(g20 + z1*g21 + z2*g22))
U.1 <- runif(n.obs)
U.2 <- runif(n.obs)
noncure.1 <- ifelse(U.1<pi.r1.z, 1, 0)
noncure.2 <- ifelse(U.2<pi.r2.z, 1, 0)
u <- runif(n.obs)
lambda1 <- 1
lambda2 <- 0.5
rho <- 3
Ul <- runif(n.obs)
Ur <- runif(n.obs,Ul,1)
Ue <- runif(n.obs)
#if(noncure.1==1){
t <- (-log(u) / (lambda1*exp(x1*b11 + x2*b12) +
lambda2*(exp(x1*b21 + x2*b22))))^(1/rho)
prob_event <- 0.05
gammaL = 0.5
gammaR = 2.5
event <- ifelse(Ue < prob_event,1,ifelse(gammaL*Ul <= t &
t <= gammaR*Ur,3,ifelse(t < gammaL*Ul,2,0)))
p1 <- (lambda1*exp(x1*b11 + x2*b12)) / ((lambda1*exp(x1*b11 + x2*b12) +
lambda2*(exp(x1*b21 + x2*b22))))
p2 <- (lambda2*exp(x1*b21 + x2*b22)) / ((lambda1*exp(x1*b11 + x2*b12) +
lambda2*(exp(x1*b21 + x2*b22))))
v <- runif(n.obs)
risk <- ifelse(v <= p1, 1, 2)
time1 <- ifelse(event==0,gammaR*Ur,ifelse(event==1,t,ifelse(event==2,
gammaL*Ul,gammaL*Ul)))
time2 <- ifelse(event==0,NA,ifelse(event==1,t,ifelse(event==2,NA,gammaR*Ur)))
noncure <- ifelse(risk==1, noncure.1, noncure.2)
#generate right censoring time for non cured
gammaC <- 1.5
Uc <- runif(n.obs, 0, gammaC)
event <- ifelse(noncure==0, 0,event)
risk <- ifelse(noncure==0 | event==0, NA, risk)
time1 <- ifelse(noncure==0, Uc, time1)
time2 <- ifelse(noncure==0, NA, time2)
tmid <- ifelse(event==3,rowMeans(cbind(time1,time2)),ifelse(event==2,
time1/2, time1))
risk2 <- ifelse(is.na(risk),0,risk)
x <- data.frame(x1,x2)
z <- data.frame(z1,z2)
simdata[[1]] <- data.frame("time"=time1,time2,x,z,event,risk,tmid,risk2,t,
noncure)
simdata
test.cf <- phcshcf_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = simdata[[1]]$risk, data = simdata[[1]],
z = as.matrix(cbind(simdata[[1]]$z1, simdata[[1]]$z2)), max.outer = 3000,
max.iter = 10, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = FALSE)
test.cf <- phcshcf_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = simdata[[1]]$risk, data = simdata[[1]],
z = as.matrix(cbind(simdata[[1]]$z1, simdata[[1]]$z2)), max.outer = 3000,
max.iter = 10, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf <- phcshcf_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = simdata[[1]]$risk, data = simdata[[1]],
z = as.matrix(cbind(simdata[[1]]$z1, simdata[[1]]$z2)), max.outer = 10,
max.iter = 3000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
simdata <- list()
n.obs <- 500
g10 <- 0.5
g20 <- 1
g11 <- 1
g12 <- -0.5
g21 <- 0.5
g22 <- -1
b11 <- 0.5
b12 <- -2
b21 <- 1
b22 <- -1
z1 <- rnorm(n.obs)
z2 <- rnorm(n.obs)
x1 <- z1
x2 <- z2
pi.r1.z <- exp(g10 + z1*g11 + z2*g12) / (1 + exp(g10 + z1*g11 + z2*g12))
pi.r2.z <- exp(g20 + z1*g21 + z2*g22) / (1 + exp(g20 + z1*g21 + z2*g22))
U.1 <- runif(n.obs)
U.2 <- runif(n.obs)
noncure.1 <- ifelse(U.1<pi.r1.z, 1, 0)
noncure.2 <- ifelse(U.2<pi.r2.z, 1, 0)
u <- runif(n.obs)
lambda1 <- 1
lambda2 <- 0.5
rho <- 3
Ul <- runif(n.obs)
Ur <- runif(n.obs,Ul,1)
Ue <- runif(n.obs)
#if(noncure.1==1){
t <- (-log(u) / (lambda1*exp(x1*b11 + x2*b12) +
lambda2*(exp(x1*b21 + x2*b22))))^(1/rho)
prob_event <- 0.05
gammaL = 0.5
gammaR = 2.5
event <- ifelse(Ue < prob_event,1,ifelse(gammaL*Ul <= t &
t <= gammaR*Ur,3,ifelse(t < gammaL*Ul,2,0)))
p1 <- (lambda1*exp(x1*b11 + x2*b12)) / ((lambda1*exp(x1*b11 + x2*b12) +
lambda2*(exp(x1*b21 + x2*b22))))
p2 <- (lambda2*exp(x1*b21 + x2*b22)) / ((lambda1*exp(x1*b11 + x2*b12) +
lambda2*(exp(x1*b21 + x2*b22))))
v <- runif(n.obs)
risk <- ifelse(v <= p1, 1, 2)
time1 <- ifelse(event==0,gammaR*Ur,ifelse(event==1,t,ifelse(event==2,
gammaL*Ul,gammaL*Ul)))
time2 <- ifelse(event==0,NA,ifelse(event==1,t,ifelse(event==2,NA,gammaR*Ur)))
noncure <- ifelse(risk==1, noncure.1, noncure.2)
#generate right censoring time for non cured
gammaC <- 1.5
Uc <- runif(n.obs, 0, gammaC)
event <- ifelse(noncure==0, 0,event)
risk <- ifelse(noncure==0 | event==0, NA, risk)
time1 <- ifelse(noncure==0, Uc, time1)
time2 <- ifelse(noncure==0, NA, time2)
tmid <- ifelse(event==3,rowMeans(cbind(time1,time2)),ifelse(event==2,
time1/2, time1))
risk2 <- ifelse(is.na(risk),0,risk)
x <- data.frame(x1,x2)
z <- data.frame(z1,z2)
simdata[[1]] <- data.frame("time"=time1,time2,x,z,event,risk,tmid,risk2,t,
noncure)
#}
#if(noncure.1==0){
#}
test.cf <- phcshcf_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = simdata[[1]]$risk, data = simdata[[1]],
z = as.matrix(cbind(simdata[[1]]$z1, simdata[[1]]$z2)), max.outer = 10,
max.iter = 3000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
load_all()
test.cf <- phcshcf_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = simdata[[1]]$risk, data = simdata[[1]],
z = as.matrix(cbind(simdata[[1]]$z1, simdata[[1]]$z2)), max.outer = 10,
max.iter = 3000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl.R", echo=TRUE)
test.cf <- phcshcf_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = simdata[[1]]$risk, data = simdata[[1]],
z = as.matrix(cbind(simdata[[1]]$z1, simdata[[1]]$z2)), max.outer = 10,
max.iter = 3000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
gammaparms$ze.C.r[[r]]
gammaparms$zi.C.r[[r]]
gammascore.Z
gammascore.mat
gammaparms
exp(0)
load_all()
rm(list = c("phcshcf_mpl"))
load_all()
rm(list = c(phcshcf_mpl))
rm(list = c('phcshcf_mpl'))
rm(list = c('phcshcf_mpl'))
load_all()
test.cf <- phcshcf_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = simdata[[1]]$risk, data = simdata[[1]],
z = as.matrix(cbind(simdata[[1]]$z1, simdata[[1]]$z2)), max.outer = 10,
max.iter = 3000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
rm(list = c('phcshcf_mpl'))
load_all()
test.cf <- phcshcf_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = simdata[[1]]$risk, data = simdata[[1]],
z = as.matrix(cbind(simdata[[1]]$z1, simdata[[1]]$z2)), max.outer = 10,
max.iter = 3000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
load_all()
test.cf <- phcshcf_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = simdata[[1]]$risk, data = simdata[[1]],
z = as.matrix(cbind(simdata[[1]]$z1, simdata[[1]]$z2)), max.outer = 10,
max.iter = 3000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
load_all()
test.cf <- phcshcf_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = simdata[[1]]$risk, data = simdata[[1]],
z = as.matrix(cbind(simdata[[1]]$z1, simdata[[1]]$z2)), max.outer = 10,
max.iter = 3000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
load_all()
test.cf <- phcshcf_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = simdata[[1]]$risk, data = simdata[[1]],
z = as.matrix(cbind(simdata[[1]]$z1, simdata[[1]]$z2)), max.outer = 10,
max.iter = 3000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
load_all()
test.cf <- phcshcf_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = simdata[[1]]$risk, data = simdata[[1]],
z = as.matrix(cbind(simdata[[1]]$z1, simdata[[1]]$z2)), max.outer = 10,
max.iter = 3000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
load_all()
test.cf <- phcshcf_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = simdata[[1]]$risk, data = simdata[[1]],
z = as.matrix(cbind(simdata[[1]]$z1, simdata[[1]]$z2)), max.outer = 10,
max.iter = 3000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
load_all()
test.cf <- phcshcf_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = simdata[[1]]$risk, data = simdata[[1]],
z = as.matrix(cbind(simdata[[1]]$z1, simdata[[1]]$z2)), max.outer = 10,
max.iter = 3000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl.R", echo=TRUE)
test.cf <- phcshcf_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = simdata[[1]]$risk, data = simdata[[1]],
z = as.matrix(cbind(simdata[[1]]$z1, simdata[[1]]$z2)), max.outer = 10,
max.iter = 3000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
gammainc
oldgamm
gammainc
gammascore
gammahess.mat
gammascore
gammahess
gammascore[[1]]
gammascore[[1]] %*% gammahess[[1]]
gammahess[[1]] %*% gammascore[[1]]
betascore
betahess
betahess[[r]] %*% betascore[[r]]
gammahess[[1]] %*% gammascore[[1]]
gammahess[[1]]
gammascore
gammainc
0.033412518 *91.00000
-0.0092670451*28.59527
0.0156221393*-49.64400
3.040539-0.2649937-0.7755455
-0.009267045*91.00000
0.0283100930*28.59527
-0.0006801676*-49.64400
-0.8433011+0.8095348+0.03376624
z
ze
zi
exp(data.matrix(ze[[r]]) %*% gamm[[r]])
ze.ezg[[r]]
ze.ezg
gammaparms$ze.ezg[[r]]
gammascore.Z[[r]]
colSums(gammascore.Z[[r]])
2 / (gammascore.Z[[r]])
colSums(2 / (gammascore.Z[[r]]))
load_all()
rm(list = c('phcshcf_mpl'))
load_all()
library(phcshMPL)
wbrt <- read.csv("//Users//josephdescallar//Documents//PhD//CSH Interval//wbrt.csv")
wbrt <- read.csv("//Users//josephdescallar//Documents//PhD//CSH Interval
//wbrt.csv")
wbrt <- read.csv("//Users//josephdescallar//Documents//PhD//CSH Interval
//wbrt.csv")
wbrt <- read.csv("//Users//josephdescallar//Documents//PhD//CSH Interval//wbrt.csv")
names(wbrt)
wbrt
#Determine first event
wbrt$timeIntra <- Fail_MRI_Date - startDate
#Determine first event
wbrt$timeIntra <- wbrt$Fail_MRI_Date - wbrt$startDate
wbrt$Fail_MRI_Date
#convert dates to numeric
wbrt$startDateNum <- as.numeric(wbrt$startDate)
wbrt$startDateNum
wbrt <- read.csv("//Users//josephdescallar//Documents//PhD//CSH Interval//wbrt.csv")
names(wbrt)
#Determine first event
wbrt$timeIntra <- wbrt$Fail_MRI_Date_Num - wbrt$startDateNum
wbrt$timeIntra
wbrt$timeDeath <- wbrt$Date_Death_Num - wbrt$startDateNum
wbrt$timeDeath
wbrt$timeLast <- wbrt$Last_Date_Num - wbrt$startDateNum
wbrt$timeLast
wbrt$risk <- ifelse(is.na(wbrt$timeIntra), NA, 1)
wbrt$risk
wbrt$risk <- ifelse(is.na(wbrt$timeIntra) & is.na(wbrt$timeDeath), NA, 1)
wbrt$risk
wbrt$risk <- ifelse(is.na(wbrt$timeIntra) & is.na(wbrt$timeDeath), NA, ifelse(wbrt$timeIntra < wbrt$timeDeath, 1,2))
wbrt$risk
wbrt$risk <- ifelse(is.na(wbrt$timeIntra) & is.na(wbrt$timeDeath), NA, ifelse(wbrt$timeIntra < wbrt$timeDeath, 1,2))
wbrt$timeIntra < wbrt$timeDeath
wbrt$risk <- ifelse(is.na(wbrt$timeIntra) & is.na(wbrt$timeDeath), NA,
ifelse(wbrt$timeIntra < wbrt$timeDeath & !is.na(wbrt$timeIntra), 1, 2))
wbrt$risk
wbrt$risk <- ifelse(is.na(wbrt$timeIntra) & is.na(wbrt$timeDeath), NA,
ifelse(wbrt$timeIntra < wbrt$timeDeath & !is.na(wbrt$timeIntra)
& !is.na(wbrt$timeDeath), 1, 2))
wbrt$risk
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk)
wbrt$risk <- ifelse(is.na(wbrt$timeIntra) & is.na(wbrt$timeDeath), NA,
ifelse(is.na(wbrt$timeIntra) & !is.na(wbrt$timeDeath), 2,
ifelse(is.na(wbrt$timeIntra) & !is.na(wbrt$timeDeath), 1,
)))
wbrt$risk <- ifelse(is.na(wbrt$timeIntra) & is.na(wbrt$timeDeath), NA,
ifelse(is.na(wbrt$timeIntra) & !is.na(wbrt$timeDeath), 2,
ifelse(is.na(wbrt$timeIntra) & !is.na(wbrt$timeDeath), 1,
3 )))
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk)
wbrt$risk <- ifelse(is.na(wbrt$timeIntra) & is.na(wbrt$timeDeath), NA,
ifelse(is.na(wbrt$timeIntra) & !is.na(wbrt$timeDeath), 2,
ifelse(!is.na(wbrt$timeIntra) & is.na(wbrt$timeDeath), 1,
3 )))
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk)
wbrt$risk <- ifelse(is.na(wbrt$timeIntra) & is.na(wbrt$timeDeath), NA,
ifelse(is.na(wbrt$timeIntra) & !is.na(wbrt$timeDeath), 2,
ifelse(!is.na(wbrt$timeIntra) & is.na(wbrt$timeDeath), 1,
1 )))
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk)
wbrt$event <- ifelse(wbrt$risk==1,3,
ifelse(wbrt$risk==2,1,NA))
wbrt$event
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk, wbrt$event)
names(wbrt)
#Calculate time to intra fail, death and censor
wbrt$timeLastMRI <- wbrt$Last_MRI_Date_Num - wbrt$startDateNum
wbrt$event <- ifelse(wbrt$risk==1,3,
ifelse(wbrt$risk==2,1,0))
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk, wbrt$event)
wbrt$event <- ifelse(wbrt$risk==1,3,
ifelse(wbrt$risk==2,1,0))
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk, wbrt$event)
wbrt$event
wbrt$event <- ifelse(wbrt$risk==1,3,
ifelse(wbrt$risk==2,1,5))
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk, wbrt$event)
wbrt$event <- ifelse(is.na(wbrt$risk),0,
ifelse(wbrt$risk==1,3,1))
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk, wbrt$event)
#Calculate time to intra fail, death and censor
wbrt$timeLastMRI <- wbrt$Last_MRI_Date_Num - wbrt$startDateNum
wbrt$time1 <- ifelse(wbrt$event==0, wbrt$timeLast,
ifelse(wbrt$event==1), wbrt$timeLastMRI,
ifelse(wbrt$event==3), wbrt$timeDeath)
wbrt$time1 <- ifelse(wbrt$event==0, wbrt$timeLast,
ifelse(wbrt$event==1, wbrt$timeLastMRI,
ifelse(wbrt$event==3, wbrt$timeDeath)))
wbrt$time1 <- ifelse(wbrt$event==0, wbrt$timeLast,
ifelse(wbrt$event==1, wbrt$timeLastMRI, wbrt$timeDeath))
wbrt$time1
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk, wbrt$event, wbrt$time1)
wbrt$time1 <- ifelse(wbrt$event==0, wbrt$timeLast,
ifelse(wbrt$event==1, wbrt$timeDeath, wbrt$timeLastMRI))
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk, wbrt$event, wbrt$time1)
wbrt$timeLastMRI
wbrt$timeLastMRI[wbrt$timeLastMRI < 0] <- 0
wbrt$timeLastMRI
wbrt$event <- ifelse(is.na(wbrt$risk),0,
ifelse(wbrt$risk==1 & wbrt$timeLastMRI != 0 ,3,
ifelse(wbrt$risk==1, 2,1)))
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk, wbrt$event)
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk, wbrt$event, wbrt$time1)
wbrt$time1 <- ifelse(wbrt$event==0, wbrt$timeLast,
ifelse(wbrt$event==1, wbrt$timeDeath, wbrt$timeLastMRI))
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk, wbrt$event, wbrt$time1)
wbrt$time2 <- ifelse(wbrt$event==0, NA,
wbrt$time2 <- ifelse(wbrt$event==0, NA,
ifelse(wbrt$event==1, wbrt$timeDeath, wbrt$timeIntra))
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk, wbrt$event, wbrt$time1, wbrt$time2)
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk, wbrt$event, wbrt$time1, wbrt$time2)
wbrt$time2 <- ifelse(wbrt$event==0, NA,
ifelse(wbrt$event==1, wbrt$timeDeath, wbrt$timeIntra))
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk, wbrt$event, wbrt$time1, wbrt$time2)
table(wbrt$treatment, wbrt$treatment2)
table(wbrt$treatment)
library(survival)
wbrt <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ treatment,
risk = wbrt$risk, data = wbrt, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
wbrt <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment),
risk = wbrt$risk, data = wbrt, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
names(wbrt)
table(wbrt$Sx)
wbrt <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment) + factor(Sx),
risk = wbrt$risk, data = wbrt, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
table(wbrt$risk)
table(wbrt$event)
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk, wbrt$event, wbrt$time1, wbrt$time2)
ifelse(wbrt$time1 > wbrt$time2)
wbrt$time1 > wbrt$time2
sum(wbrt$time1 > wbrt$time2)
sum(wbrt$time1 > wbrt$time2, na.rm=TRUE)
wbrt.sub <- wbrt[which(wbrt$time1 <= wbrt$time2),]
wbrt.sub
wbrt.sub <- wbrt[which(wbrt$time1 <= wbrt$time2 | is.na(wbrt$time2)),]
wbrt.sub
wbrt.analysis <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment) + factor(Sx),
risk = wbrt.sub$risk, data = wbrt.sub, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
install()
wbrt.analysis <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment) + factor(Sx),
risk = wbrt.sub$risk, data = wbrt.sub, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
table(wbrt$treatment)
wbrt$treatment.n <- ifelse(wbrt$treatment=='Observation',1,2)
table(wbrt$treatment.n)
table(wbrt$treatment)
table(wbrt$Sx)
names(wbrt)
wbrt.analysis <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment.n) + factor(sex),
risk = wbrt.sub$risk, data = wbrt.sub, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
wbrt$treatment.n <- ifelse(wbrt$treatment=='Observation',1,2)
wbrt.sub <- wbrt[which(wbrt$time1 <= wbrt$time2 | is.na(wbrt$time2)),]
wbrt.analysis <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment.n) + factor(sex),
risk = wbrt.sub$risk, data = wbrt.sub, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
table(wbrt$sex)
source("~/Documents/My R packages/phcshMPL/R/phcsh_mpl.R", echo=TRUE)
debugSource("~/Documents/My R packages/phcshMPL/R/phcsh_mpl.R", echo=TRUE)
wbrt.analysis <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment.n) + factor(sex),
risk = wbrt.sub$risk, data = wbrt.sub, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
source("~/Documents/My R packages/phcshMPL/R/phcsh_mpl.R", echo=TRUE)
wbrt.analysis <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment.n) + factor(sex),
risk = wbrt.sub$risk, data = wbrt.sub, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
source("~/Documents/My R packages/phcshMPL/R/phcsh_mpl.R", echo=TRUE)
wbrt.analysis <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment.n) + factor(sex),
risk = wbrt.sub$risk, data = wbrt.sub, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
source("~/Documents/My R packages/phcshMPL/R/phcsh_mpl.R", echo=TRUE)
wbrt.analysis <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment.n) + factor(sex),
risk = wbrt.sub$risk, data = wbrt.sub, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
source("~/Documents/My R packages/phcshMPL/R/phcsh_mpl.R", echo=TRUE)
wbrt.analysis <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment.n) + factor(sex),
risk = wbrt.sub$risk, data = wbrt.sub, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
source("~/Documents/My R packages/phcshMPL/R/phcsh_mpl.R", echo=TRUE)
wbrt.analysis <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment.n) + factor(sex),
risk = wbrt.sub$risk, data = wbrt.sub, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
source("~/Documents/My R packages/phcshMPL/R/phcsh_mpl.R", echo=TRUE)
wbrt.analysis <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment.n) + factor(sex),
risk = wbrt.sub$risk, data = wbrt.sub, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
cbind(wbrt$timeIntra, wbrt$timeDeath, wbrt$risk, wbrt$event, wbrt$time1, wbrt$time2)
source("~/Documents/My R packages/phcshMPL/R/phcsh_mpl.R", echo=TRUE)
wbrt.analysis <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment.n) + factor(sex),
risk = wbrt.sub$risk, data = wbrt.sub, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
source("~/Documents/My R packages/phcshMPL/R/phcsh_mpl.R", echo=TRUE)
wbrt.analysis <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment.n) + factor(sex),
risk = wbrt.sub$risk, data = wbrt.sub, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
source("~/Documents/PhD/CSH Interval/phcsh_mpl3.R", echo=TRUE)
wbrt.analysis3 <- phcsh_mpl3(Surv(time1, time2, event=event, "interval") ~ factor(treatment.n) + factor(sex),
risk = wbrt.sub$risk, data = wbrt.sub, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
wbrt.analysis <- phcsh_mpl(Surv(time1, time2, event=event, "interval") ~ factor(treatment.n) + factor(sex),
risk = wbrt.sub$risk, data = wbrt.sub, max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.package <- phcsh_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = cric.scen1.r47.n200[[1]]$risk,
data = cric.scen1.r47.n200[[1]], max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
#create dataset
cric.scen1.r47.n200 <- gen.cric.data(n.datasets = 1000, n.obs = 200,
prob_event = 0.05, rho = 3, lambda1 = 1, lambda2 = 1,
betas = list(c(1,0.5), c(0.5,0.5)), gammaL = 0.5, gammaR = 0.91)
test.package <- phcsh_mpl(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = cric.scen1.r47.n200[[1]]$risk,
data = cric.scen1.r47.n200[[1]], max.outer = 10, max.iter = 3000,
lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL, aps = TRUE,
knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
