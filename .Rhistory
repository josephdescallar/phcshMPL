create_package("/Users/josephdescallar/Documents/My R packages/phcshMPL")
library(devtools)
create_package("/Users/josephdescallar/Documents/My R packages/phcshMPL")
8/146
1/146
5/146
2/146
8/60
library(devtools)
check()
check()
use_package("survival")
use_r("phcsh_mpl_control")
check()
check()
check()
check()
document()
document()
?phcsh_mpl
survivalMPL::coxph_mpl()
survivalMPL::coxph_mpl
?survivalMPL::coxph_mpl
document()
?phcsh_mpl
document()
?phcsh_mpl
?survivalMPL::coxph_mpl
document()
?phcsh_mpl
?survivalMPL::coxph_mpl
document()
?phcsh_mpl
?survivalMPL::coxph_mpl
use_package("statmod")
use_package("splines2")
check()
check()
check()
check()
check()
check()
check()
check()
check()
check()
check()
check()
check()
use_package("Matrix")
check()
check()
check()
check()
check()
check()
check()
library(Matrix)
check()
check()
check()
check()
check()
check()
check()
check()
check()
check()
check()
use_package("utils")
check()
check()
check()
check()
check()
use_r("plot.phcsh_mpl")
use_r("plot_phcsh_mpl")
check()
check()
check()
check()
check()
check()
check()
use_r("summary_phcsh_mpl")
check()
use_package("stats")
check()
document()
check()
check()
check()
check()
gen.cric.data <- function(n.datasets = 1000, n.obs = 200, prob_event = 0.2, rho = 3, lambda1 = 1,
lambda2 = 0.5, betas = list(c(0.5,-2), c(1,-1)), gammaL = 0.5, gammaR = 2.5){
simdata <- list()
for(sim in 1:n.datasets){
b11 <- betas[[1]][1]
b12 <- betas[[1]][2]
b21 <- betas[[2]][1]
b22 <- betas[[2]][2]
seed <- sim
set.seed(seed)
#Generate U~unif(0,1)
u <- runif(n.obs)
#Generate x1 and x2
#x1 <- runif(n.obs, 0, 2)
#x2 <- rbinom(n.obs, 1, 0.5)
x1 <- rnorm(n.obs, mean=0, sd=1)
x2 <- rnorm(n.obs, mean=0, sd=1)
#x2 <- runif(n.obs, 0, 2)
x <- data.matrix(data.frame(x1,x2))
#Calculate t random variable
t <- (-log(u) / (lambda1*exp(x1*b11 + x2*b12) + lambda2*(exp(x1*b21 + x2*b22))))^(1/rho)
Ul <- runif(n.obs)
Ur <- runif(n.obs,Ul,1)
Ue <- runif(n.obs)
event <- ifelse(Ue < prob_event,1,ifelse(gammaL*Ul <= t & t <= gammaR*Ur,3,ifelse(t < gammaL*Ul,2,0)))
#Generate V to determine which risk t belongs
p1 <- (lambda1*exp(x1*b11 + x2*b12)) / ((lambda1*exp(x1*b11 + x2*b12) + lambda2*(exp(x1*b21 + x2*b22))))
p2 <- (lambda2*exp(x1*b21 + x2*b22)) / ((lambda1*exp(x1*b11 + x2*b12) + lambda2*(exp(x1*b21 + x2*b22))))
v <- runif(n.obs)
time1 <- ifelse(event==0,gammaR*Ur,ifelse(event==1,t,ifelse(event==2,gammaL*Ul,gammaL*Ul)))
time2 <- ifelse(event==0,NA,ifelse(event==1,t,ifelse(event==2,NA,gammaR*Ur)))
tmid <- ifelse(event==3,rowMeans(cbind(time1,time2)),ifelse(event==2,time1/2, time1))
risk <- ifelse(event==0,NA,ifelse(v <= p1, 1, 2))
risk_1 <- ifelse((event==1 | event==2 | event==3) & risk == 1, 1, 0)
risk_2 <- ifelse((event==1 | event==2 | event==3) & risk == 2, 1, 0)
risk2 <- ifelse(is.na(risk),0,risk)
x <- data.frame(x1,x2)
simdata[[sim]] <- data.frame("time"=time1,time2,x,event,risk,tmid,risk2,t,risk_1,risk_2)
}
simdata
}
install()
use_package("Surv")
document()
document()
document()
document()
