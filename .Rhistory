aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
gammainc
newgamm
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
llik0
llik1
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
llik0
llik1
llparms$zr.ezg
gammainc
gammascore
gammahess
llparms$tr.S
llparms$tr.S.pop
llparms$zr.pi
llparms$ze.pi
llparms$zi.pi
llparms$tr.S.pop
source("~/Documents/PhD/CR cure fraction/Generate phcshcf data.R", echo=TRUE)
testsim <- gen.phcshcf.data(n.datasets = 5, n.obs = 1000, prob_event = 0.2, rho = 3, lambda1 = 1,
lambda2 = 0.5, betas = list(c(0.5,-2), c(1,-1)), gammaL = 0.5, gammaR = 2.5,
pi.r.z.coef =c(0.5,0.5, -0.5),
cureMin = 1.5, cureMax = 4.5)
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
load_all()
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
View(phcshcf_mpl2)
View(phcshcf_mpl2)
View(phcshcf_mpl2)
View(phcshcf_mpl2)
testsim[[1]]
testsim <- gen.phcshcf.data(n.datasets = 5, n.obs = 1000, prob_event = 0.2, rho = 3, lambda1 = 1,
lambda2 = 0.5, betas = list(c(0.5,-2), c(1,-1)), gammaL = 0.5, gammaR = 2.5,
pi.r.z.coef =c(1.5,0.5, -0.5),
cureMin = 1.5, cureMax = 4.5)
testsim[[1]]
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
gammahess.mat
gammascore.mat
gammascore.z
gammascore.1
llparms$ze.ezg
unlist(llparms$ze.ezg)
n.e
n.i
369+197
unlist(llparms$zi.ezg)
unlist(llparms$zi.ezg)
((llparms$tr.S - 1) *
llparms$zr.ezg) / ((llparms$tr.S.pop)
* (1+llparms$zr.ezg)^2)
t(gammascore.z) %*% gammascore.mat
t(t(gammascore.z) %*% gammascore.mat)
gammascore.mat
solve(t(gammascore.z) %*% gammahess.mat %*%
gammascore.z)
t(gammascore.z) %*% gammascore.mat %*%
data.matrix(gammascore.1)
gammahess
gammainc
gammahess %*% gammascore
Z
testsim[[1]]
testsim <- gen.phcshcf.data(n.datasets = 5, n.obs = 1000, prob_event = 0.2, rho = 3, lambda1 = 1,
lambda2 = 0.5, betas = list(c(0.5,-2), c(1,-1)), gammaL = 0.5, gammaR = 2.5,
pi.r.z.coef =c(1.5,0.5, -0.5),
cureMin = 1.5, cureMax = 4.5)
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
gammascore.z
t(gammascore.z) %*% gammascore.mat
t(t(gammascore.z) %*% gammascore.mat)
n.r
c(if(n.r!=0) ((llparms$tr.S - 1) *
llparms$zr.ezg) / ((llparms$tr.S.pop)
* (1+llparms$zr.ezg)^2), if(sum(unlist(n.e))!=0) 1 /
(1 + unlist(llparms$ze.ezg)), if(sum(unlist(n.i))!=0) 1 /
(1 + unlist(llparms$zi.ezg)))
diag(gammascore.mat)
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
zr.ezg
zr.pi
zr.ezg
pi.r.z.coef = c(1.5,0.5, -0.5)
pi.r.z.coef
pi.r.z.coef[1]
pi.r.z.coef[2]
pi.r.z.coef[3]
testsim <- gen.phcshcf.data(n.datasets = 5, n.obs = 1000, prob_event = 0.2, rho = 3, lambda1 = 1,
lambda2 = 0.5, betas = list(c(0.5,-2), c(1,-1)), gammaL = 0.5, gammaR = 2.5,
pi.r.z.coef =c(1.5,0.5, 0.5),
cureMin = 1.5, cureMax = 4.5)
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
testsim <- gen.phcshcf.data(n.datasets = 5, n.obs = 1000, prob_event = 0.2, rho = 3, lambda1 = 1,
lambda2 = 0.5, betas = list(c(0.5,-2), c(1,-1)), gammaL = 0.5, gammaR = 2.5,
pi.r.z.coef =c(1.5,1.5, 1.5),
cureMin = 1.5, cureMax = 4.5)
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
testsim <- gen.phcshcf.data(n.datasets = 5, n.obs = 1000, prob_event = 0.2, rho = 3, lambda1 = 1,
lambda2 = 0.5, betas = list(c(0.5,-2), c(1,-1)), gammaL = 0.5, gammaR = 2.5,
pi.r.z.coef =c(0.5, 0.5, 0.5),
cureMin = 1.5, cureMax = 4.5)
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
Uc
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
ze.ezg
ze.pi
zi.pi
zr.pi
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
gammascore.mat
diag(gammascore.mat)
gammascore.z
gammascore.z * diag(gammascore.mat)
colSums(gammascore.z * diag(gammascore.mat))
gammascore
colSums(gammascore.z * diag(gammahess.mat))
gammahess
colSums(gammascore.z * diag(gammahess.mat) * gammascore.z)
1 / colSums(gammascore.z * diag(gammahess.mat) * gammascore.z)
(1 / colSums(gammascore.z * diag(gammahess.mat) * gammascore.z)) * gammascore
testsim[[1]]
pi.z
testsim[[1]]
testsim <- gen.phcshcf.data(n.datasets = 5, n.obs = 1000, prob_event = 0.2, rho = 3, lambda1 = 1,
lambda2 = 0.5, betas = list(c(0.5,-2), c(1,-1)), gammaL = 0.5, gammaR = 2,
pi.r.z.coef =c(0.5, 0.5, 0.5),
cureMin = 1.5, cureMax = 4.5)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
source("~/Documents/PhD/CR cure fraction/Generate phcshcf data.R", echo=TRUE)
testsim <- gen.phcshcf.data(n.datasets = 5, n.obs = 1000, prob_event = 0.2, rho = 3, lambda1 = 1,
lambda2 = 0.5, betas = list(c(0.5,-2), c(1,-1)), gammaL = 0.5, gammaR = 2,
pi.r.z.coef =c(0.5, 0.5, 0.5),
cureMin = 1.5, cureMax = 4.5)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
source("~/Documents/PhD/CR cure fraction/Generate phcshcf data.R", echo=TRUE)
testsim <- gen.phcshcf.data(n.datasets = 5, n.obs = 1000, prob_event = 0.2, rho = 3, lambda1 = 1,
lambda2 = 0.5, betas = list(c(0.5,-2), c(1,-1)), gammaL = 0.5, gammaR = 2,
pi.r.z.coef =c(0.5, 0.5, 0.5),
cureMin = 1.5, cureMax = 4.5)
source("~/Documents/PhD/CR cure fraction/Generate phcshcf data.R", echo=TRUE)
testsim <- gen.phcshcf.data(n.datasets = 5, n.obs = 1000, prob_event = 0.2, rho = 3, lambda1 = 1,
lambda2 = 0.5, betas = list(c(0.5,-2), c(1,-1)), gammaL = 0.5, gammaR = 2,
pi.r.z.coef =c(0.5, 0.5, 0.5),
cureMin = 1.5, cureMax = 4.5)
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
source("~/Documents/PhD/CR cure fraction/Generate phcshcf data.R", echo=TRUE)
source("~/Documents/PhD/CR cure fraction/Generate phcshcf data.R", echo=TRUE)
testsim <- gen.phcshcf.data(n.datasets = 5, n.obs = 1000, prob_event = 0.2, rho = 3, lambda1 = 1,
lambda2 = 0.5, betas = list(c(0.5,-2), c(1,-1)), gammaL = 0.5, gammaR = 2,
pi.r.z.coef =c(0.5, 0.5, 0.5),
cureMin = 1.5, cureMax = 4.5)
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
testsim <- gen.phcshcf.data(n.datasets = 5, n.obs = 1000, prob_event = 0.2, rho = 3, lambda1 = 1,
lambda2 = 0.5, betas = list(c(0.5,-2), c(1,-1)), gammaL = 0.5, gammaR = 2,
pi.r.z.coef =c(0.5, 0.5, 0.5),
cureMin = 1.5, cureMax = 2.5)
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
testsim[[1]]
source("~/Documents/PhD/CR cure fraction/Generate phcshcf data.R", echo=TRUE)
testsim <- gen.phcshcf.data(n.datasets = 5, n.obs = 1000, prob_event = 0.2, rho = 3, lambda1 = 1,
lambda2 = 0.5, betas = list(c(0.5,-2), c(1,-1)), gammaL = 0.5, gammaR = 2,
pi.r.z.coef =c(0.5, 0.5, 0.5),
cureMin = 1.5, cureMax = 2.5)
testsim[[1]]
testsim[[1]]
load_all()
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
testdata <- testsim[[1]]
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
gammascore
gammahess
gammahess*gammahess
gammahess %*% gammascore
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
gammainc
XC
ZC
mean_o
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
isk, data = testdata,
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
gammascore.z
gammascore.mat
gammascore
gammascore.z
t(gammascore.z) %*% gammahess.mat %*%
gammascore.z
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
ZC
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
ZC
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
gammascore.z
zr
xr
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
zr
xr
cbind(xr, zr)
cbind(xe, zr)
cbind(xe, ze)
cbind(xe[[1]], ze[[1]])
cbind(xe[[2]], ze[[2]])
cbind(xi[[1]], zi[[1]])
debugSource("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
source("~/Documents/My R packages/phcshMPL/R/phcshcf_mpl2.R", echo=TRUE)
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
test.cf <- phcshcf_mpl2(Surv(time, time2, event=event, "interval") ~ x1 + x2,
risk = testdata$risk, data = testdata,
z = as.matrix(cbind(testdata$z1, testdata$z2)), max.outer = 1,
max.iter = 1000, lambda = c(1e-5,1e-5), n.basis = NULL, iknots.pos = NULL,
aps = TRUE, knots.perc.limit = c(0.05,0.95), tmid = TRUE, iter.disp = TRUE)
test.cf
